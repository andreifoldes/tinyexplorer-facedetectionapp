<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Browser Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        button {
            padding: 10px 20px;
            margin: 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        .result {
            margin-top: 10px;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 4px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <h1>File Browser Test Page</h1>
    
    <div class="test-section">
        <h2>File Selection Test</h2>
        <button onclick="testBrowseFile()">Browse File</button>
        <div id="file-result" class="result">No file selected</div>
    </div>
    
    <div class="test-section">
        <h2>Folder Selection Test</h2>
        <button onclick="testBrowseFolder()">Browse Folder</button>
        <div id="folder-result" class="result">No folder selected</div>
    </div>
    
    <div class="test-section">
        <h2>GraphQL Backend Test</h2>
        <button onclick="testBackend()">Test Hello Query</button>
        <button onclick="testCalculator()">Test Calculator</button>
        <div id="backend-result" class="result">Click a button to test</div>
    </div>

    <script>
        function testBrowseFile() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = (e) => {
                if (e.target.files.length > 0) {
                    const file = e.target.files[0];
                    document.getElementById('file-result').innerHTML = 
                        `Selected file: ${file.name}<br>Size: ${file.size} bytes<br>Type: ${file.type}`;
                }
            };
            input.click();
        }
        
        function testBrowseFolder() {
            const input = document.createElement('input');
            input.type = 'file';
            input.webkitdirectory = true;
            input.onchange = (e) => {
                if (e.target.files.length > 0) {
                    const files = Array.from(e.target.files);
                    const folderName = files[0].webkitRelativePath.split('/')[0];
                    const imageFiles = files.filter(f => 
                        f.type.startsWith('image/') || 
                        /\.(jpg|jpeg|png|gif|bmp|webp)$/i.test(f.name)
                    );
                    
                    document.getElementById('folder-result').innerHTML = 
                        `Selected folder: ${folderName}<br>` +
                        `Total files: ${files.length}<br>` +
                        `Image files: ${imageFiles.length}<br>` +
                        `Sample files: ${files.slice(0, 5).map(f => f.name).join(', ')}`;
                }
            };
            input.click();
        }
        
        async function testBackend() {
            try {
                const response = await fetch('http://localhost:5001/graphql/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        query: '{ hello(signingkey: "devkey") }'
                    })
                });
                
                const data = await response.json();
                document.getElementById('backend-result').innerHTML = 
                    `Hello query result: ${JSON.stringify(data, null, 2)}`;
            } catch (error) {
                document.getElementById('backend-result').innerHTML = 
                    `Error: ${error.message}`;
            }
        }
        
        async function testCalculator() {
            try {
                const response = await fetch('http://localhost:5001/graphql/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        query: '{ calc(signingkey: "devkey", math: "10 * 5 + 2") }'
                    })
                });
                
                const data = await response.json();
                document.getElementById('backend-result').innerHTML = 
                    `Calculator result (10 * 5 + 2): ${JSON.stringify(data, null, 2)}`;
            } catch (error) {
                document.getElementById('backend-result').innerHTML = 
                    `Error: ${error.message}`;
            }
        }
    </script>
</body>
</html> 